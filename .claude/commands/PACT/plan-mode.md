---
description: Multi-agent planning consultation (no implementation)
argument-hint: [e.g., add user authentication with JWT]
---
Create a comprehensive implementation plan for: $ARGUMENTS

**This is PLANNING ONLY** ‚Äî no code changes, no git branches, no implementation.

## Your Workflow

### Phase 0: Orchestrator Analysis

Using extended thinking, analyze the task:
- What is the full scope of this task?
- Which PACT phases are involved?
- Which specialists should be consulted?
- What are the key planning questions for each specialist?
- What's the estimated complexity (Low/Medium/High/Very High)?

Determine which specialists to invoke based on the task:
- **üìö pact-preparer**: Always include for research/context needs
- **üèõÔ∏è pact-architect**: Include for any structural or design decisions
- **üíª pact-backend-coder**: Include if server-side work is involved
- **üé® pact-frontend-coder**: Include if client-side work is involved
- **üóÑÔ∏è pact-database-engineer**: Include if data layer work is involved
- **üß™ pact-test-engineer**: Always include for testing strategy

Skip specialists clearly not relevant (e.g., skip database engineer for pure UI work).

### Phase 1: Parallel Specialist Consultation

Invoke relevant specialists **in parallel**, each in **planning-only mode**.

**Use this prompt template for each specialist:**

```
PLANNING CONSULTATION ONLY ‚Äî No implementation, no code changes.

Task: {task description}

As the {role} specialist, provide your planning perspective:

1. SCOPE IN YOUR DOMAIN
   - What work is needed in your area of expertise?
   - What's the estimated effort (Low/Medium/High)?

2. DEPENDENCIES & INTERFACES
   - What dependencies exist with other domains?
   - What interfaces or contracts need definition?
   - What do you need from other specialists?

3. KEY DECISIONS & TRADE-OFFS
   - What are the important decisions in your domain?
   - What are the options and trade-offs?
   - What's your recommendation?

4. RISKS & CONCERNS
   - What could go wrong?
   - What unknowns need investigation?
   - What assumptions are you making?

5. RECOMMENDED APPROACH
   - What's your suggested approach?
   - What sequence of steps do you recommend?
   - What should be done first?

Output structured analysis for orchestrator synthesis.
Do NOT implement anything ‚Äî planning consultation only.
```

**Domain-specific additions to the template:**

For **üìö pact-preparer**, also ask:
- What documentation/research is needed before implementation?
- What external APIs or libraries need investigation?
- What stakeholder clarifications are needed?

For **üèõÔ∏è pact-architect**, also ask:
- What components/modules are affected or needed?
- What design patterns should be applied?
- What interface contracts need definition?

For **coders** (backend/frontend/database), also ask:
- What files need modification or creation?
- What existing patterns in the codebase should be followed?
- What's the implementation sequence?

For **üß™ pact-test-engineer**, also ask:
- What test scenarios are critical (happy path, errors, edge cases)?
- What coverage targets make sense?
- What test data or fixtures are needed?

### Phase 2: Orchestrator Synthesis

After collecting all specialist outputs, use extended thinking to synthesize:

1. **Identify Agreements**
   - Where do specialists align?
   - What's the consensus approach?

2. **Identify Conflicts**
   - Where do specialists disagree?
   - Can you resolve the conflict with a clear recommendation?
   - If not, flag for user decision

3. **Determine Sequencing**
   - What's the optimal order of phases?
   - What can be parallelized?
   - What are the dependencies?

4. **Assess Cross-Cutting Concerns**
   - Security implications?
   - Performance implications?
   - Accessibility implications? (if frontend)
   - Observability/logging needs?

5. **Build Unified Roadmap**
   - Create step-by-step implementation plan
   - Map steps to specialists
   - Identify the commit sequence

6. **Risk Assessment**
   - Aggregate risks from all specialists
   - Assess overall project risk
   - Identify mitigation strategies

### Phase 3: Plan Output

Save the synthesized plan to `docs/plans/{feature-slug}-plan.md`.

**Use this structure:**

```markdown
# Implementation Plan: {Feature Name}

> Generated by `/PACT:plan-mode` on {date}
> Status: PENDING APPROVAL

## Summary

{2-3 sentence overview of what will be implemented and the high-level approach}

---

## Specialist Perspectives

### üìã Preparation Phase
**Effort**: {Low/Medium/High}

#### Research Needed
- [ ] {Research item}

#### Dependencies to Map
- {Dependency}

#### Questions to Resolve
- [ ] {Question}

---

### üèóÔ∏è Architecture Phase
**Effort**: {Low/Medium/High}

#### Components Affected
| Component | Change Type | Impact |
|-----------|-------------|--------|
| {Name} | New/Modify | {Description} |

#### Design Approach
{Description of architectural approach}

#### Key Decisions
| Decision | Options | Recommendation | Rationale |
|----------|---------|----------------|-----------|
| {Decision} | {A, B, C} | {B} | {Why} |

#### Interface Contracts
{Interface definitions or descriptions}

---

### üíª Code Phase
**Effort**: {Low/Medium/High}

#### Files to Modify
| File | Changes |
|------|---------|
| {path} | {description} |

#### Files to Create
| File | Purpose |
|------|---------|
| {path} | {description} |

#### Implementation Sequence
1. {Step}
2. {Step}

---

### üß™ Test Phase
**Effort**: {Low/Medium/High}

#### Test Scenarios
| Scenario | Type | Priority |
|----------|------|----------|
| {Scenario} | Unit/Integration/E2E | P0/P1/P2 |

#### Coverage Targets
- Critical path: {X}%
- Overall target: {Y}%

#### Test Data Needs
- {Requirement}

---

## Synthesized Implementation Roadmap

### Phase Sequence
{Visual or textual representation of the workflow}

### Commit Sequence (Proposed)
1. `{type}: {description}` ‚Äî {what this commit does}
2. `{type}: {description}` ‚Äî {what this commit does}

---

## Cross-Cutting Concerns

| Concern | Status | Notes |
|---------|--------|-------|
| Security | {Ready/Needs attention/N/A} | {Notes} |
| Performance | {Ready/Needs attention/N/A} | {Notes} |
| Accessibility | {Ready/Needs attention/N/A} | {Notes} |
| Observability | {Ready/Needs attention/N/A} | {Notes} |

---

## Open Questions

### Require User Decision
- [ ] **{Question}**: {Context and options for user to decide}

### Require Further Research
- [ ] **{Question}**: {What needs investigation during Prepare phase}

---

## Risk Assessment

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| {Risk} | Low/Med/High | Low/Med/High | {Strategy} |

---

## Scope Assessment

- **Overall Complexity**: {Low/Medium/High/Very High}
- **Estimated Files**: {N} modified, {M} new
- **Specialists Required**: {List}
- **External Dependencies**: {Yes/No ‚Äî details}

---

## Next Steps

To implement this plan after approval:
```
/PACT:orchestrate {task description}
```

The orchestrator should reference this plan during execution.
```

### Phase 4: Present to User

After saving the plan:

1. Present a concise summary to the user
2. Highlight any **open questions requiring user decision**
3. Note the **overall complexity and scope**
4. Explain that after approval, they can run `/PACT:orchestrate` to implement

**Do NOT proceed to implementation** ‚Äî await user approval or feedback.

---

## When to Recommend Alternative Commands

If during Phase 0 analysis you determine:

- **Task is trivial** (typo, config change, single-line fix) ‚Üí Recommend `/PACT:comPACT` instead
- **Task is unclear** ‚Üí Ask clarifying questions before proceeding with planning
- **Task requires immediate research first** ‚Üí Recommend running preparation phase alone first

---

## Integration with /PACT:orchestrate

After the user approves the plan:

1. User runs `/PACT:orchestrate {same task}`
2. Orchestrator should check for existing plan in `docs/plans/`
3. If plan exists, use it as the implementation specification
4. Specialists receive relevant sections of the plan as context
