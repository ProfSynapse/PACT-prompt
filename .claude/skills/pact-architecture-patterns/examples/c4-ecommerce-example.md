# C4 Diagram Example: E-Commerce Platform

## System Context (Level 1)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                              USERS                                       │
│                                                                          │
│    ┌──────────────┐     ┌──────────────┐     ┌──────────────┐          │
│    │   Customer   │     │    Admin     │     │   Seller     │          │
│    │              │     │              │     │              │          │
│    │ Browses and  │     │ Manages      │     │ Lists and    │          │
│    │ purchases    │     │ platform     │     │ manages      │          │
│    │ products     │     │              │     │ products     │          │
│    └──────┬───────┘     └──────┬───────┘     └──────┬───────┘          │
│           │                    │                    │                    │
└───────────┼────────────────────┼────────────────────┼────────────────────┘
            │                    │                    │
            │         HTTPS      │         HTTPS      │
            ▼                    ▼                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                          │
│                    ┌───────────────────────────┐                        │
│                    │                           │                        │
│                    │     E-COMMERCE PLATFORM   │                        │
│                    │                           │                        │
│                    │  Allows customers to      │                        │
│                    │  browse products, place   │                        │
│                    │  orders, and track        │                        │
│                    │  deliveries               │                        │
│                    │                           │                        │
│                    └─────────────┬─────────────┘                        │
│                                  │                                       │
└──────────────────────────────────┼───────────────────────────────────────┘
                                   │
         ┌────────────────┬────────┴────────┬────────────────┐
         │                │                 │                │
         ▼                ▼                 ▼                ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│   Stripe     │  │   SendGrid   │  │   Shippo     │  │   Auth0      │
│              │  │              │  │              │  │              │
│   Payment    │  │   Email      │  │   Shipping   │  │   Identity   │
│   Processing │  │   Service    │  │   API        │  │   Provider   │
└──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘
```

---

## Container Diagram (Level 2)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         E-COMMERCE PLATFORM                              │
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                        WEB LAYER                                 │    │
│  │                                                                  │    │
│  │   ┌──────────────┐                      ┌──────────────┐        │    │
│  │   │   Web App    │                      │  Admin SPA   │        │    │
│  │   │   (Next.js)  │                      │  (React)     │        │    │
│  │   │              │                      │              │        │    │
│  │   │  Customer    │                      │  Admin       │        │    │
│  │   │  storefront  │                      │  dashboard   │        │    │
│  │   └──────┬───────┘                      └──────┬───────┘        │    │
│  │          │                                     │                 │    │
│  └──────────┼─────────────────────────────────────┼─────────────────┘    │
│             │                                     │                      │
│             │ HTTPS/JSON                          │ HTTPS/JSON           │
│             ▼                                     ▼                      │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                       API LAYER                                  │    │
│  │                                                                  │    │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │    │
│  │   │   API        │  │   Order      │  │   Product    │         │    │
│  │   │   Gateway    │──│   Service    │  │   Service    │         │    │
│  │   │   (Kong)     │  │   (Node.js)  │  │   (Node.js)  │         │    │
│  │   └──────────────┘  └──────┬───────┘  └──────┬───────┘         │    │
│  │                            │                  │                  │    │
│  │                     ┌──────┴───────┐  ┌──────┴───────┐         │    │
│  │                     │   Payment    │  │   Search     │         │    │
│  │                     │   Service    │  │   Service    │         │    │
│  │                     │   (Node.js)  │  │ (Elasticsearch)│        │    │
│  │                     └──────────────┘  └──────────────┘         │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                       DATA LAYER                                 │    │
│  │                                                                  │    │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │    │
│  │   │  PostgreSQL  │  │    Redis     │  │   S3         │         │    │
│  │   │  (Primary)   │  │   (Cache)    │  │  (Media)     │         │    │
│  │   └──────────────┘  └──────────────┘  └──────────────┘         │    │
│  │                                                                  │    │
│  │   ┌──────────────┐  ┌──────────────┐                            │    │
│  │   │   RabbitMQ   │  │ Elasticsearch│                            │    │
│  │   │   (Events)   │  │  (Search)    │                            │    │
│  │   └──────────────┘  └──────────────┘                            │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## Component Diagram (Level 3) - Order Service

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           ORDER SERVICE                                  │
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                      PRESENTATION LAYER                          │    │
│  │                                                                  │    │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │    │
│  │   │   Order      │  │   Webhook    │  │   Health     │         │    │
│  │   │   Controller │  │   Controller │  │   Controller │         │    │
│  │   └──────┬───────┘  └──────┬───────┘  └──────────────┘         │    │
│  │          │                 │                                     │    │
│  └──────────┼─────────────────┼─────────────────────────────────────┘    │
│             │                 │                                          │
│             ▼                 ▼                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                      APPLICATION LAYER                           │    │
│  │                                                                  │    │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │    │
│  │   │   Create     │  │   Process    │  │   Cancel     │         │    │
│  │   │   Order      │  │   Payment    │  │   Order      │         │    │
│  │   │   UseCase    │  │   UseCase    │  │   UseCase    │         │    │
│  │   └──────┬───────┘  └──────┬───────┘  └──────┬───────┘         │    │
│  │          │                 │                 │                   │    │
│  └──────────┼─────────────────┼─────────────────┼───────────────────┘    │
│             │                 │                 │                        │
│             ▼                 ▼                 ▼                        │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                        DOMAIN LAYER                              │    │
│  │                                                                  │    │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │    │
│  │   │   Order      │  │   OrderItem  │  │   OrderEvent │         │    │
│  │   │   Entity     │  │   Entity     │  │   (Domain)   │         │    │
│  │   └──────────────┘  └──────────────┘  └──────────────┘         │    │
│  │                                                                  │    │
│  │   ┌──────────────┐  ┌──────────────┐                            │    │
│  │   │   Order      │  │   Payment    │                            │    │
│  │   │   Repository │  │   Gateway    │                            │    │
│  │   │   Interface  │  │   Interface  │                            │    │
│  │   └──────────────┘  └──────────────┘                            │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                    INFRASTRUCTURE LAYER                          │    │
│  │                                                                  │    │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │    │
│  │   │   Postgres   │  │   Stripe     │  │   RabbitMQ   │         │    │
│  │   │   Order      │  │   Payment    │  │   Event      │         │    │
│  │   │   Repository │  │   Gateway    │  │   Publisher  │         │    │
│  │   └──────────────┘  └──────────────┘  └──────────────┘         │    │
│  │                                                                  │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## Key Decisions

| Decision | Rationale |
|----------|-----------|
| API Gateway (Kong) | Centralized auth, rate limiting, routing |
| Event-driven (RabbitMQ) | Decoupled services, async processing |
| PostgreSQL | ACID compliance for orders/payments |
| Elasticsearch | Fast product search, faceted filtering |
| Redis | Session storage, cart caching |

---
*Generated from pact-architecture-patterns skill example*
